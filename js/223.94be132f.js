"use strict";(self["webpackChunkjeux_educatifs"]=self["webpackChunkjeux_educatifs"]||[]).push([[223],{1223:(t,e,a)=>{a.r(e),a.d(e,{default:()=>S});a(2010);var i=a(6768),r=a(4232),s={class:"game-container"},n={key:0,class:"instructions"},c={key:1,class:"betting-section"},o={class:"car-options"},l=["onClick"],h=["disabled"],d={class:"race-track-container"},u={ref:"raceTrack",width:"1000",height:"1000",class:"race-track"},f={key:2,class:"podium-container"},k={class:"podium"},p={class:"podium-place second-place"},m={class:"podium-place first-place"},v={class:"podium-place third-place"},g={class:"result-message"},y={key:0},P={key:1},C={key:2},x={key:3};function w(t,e,a,w,T,L){var b,R,S,F,M=(0,i.g2)("router-link"),W=(0,i.g2)("Fireworks");return(0,i.uX)(),(0,i.CE)("div",s,[e[9]||(e[9]=(0,i.Lk)("h1",null,"Course de Voitures",-1)),T.raceStarted?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",n,e[2]||(e[2]=[(0,i.Lk)("p",null,"Choisis une voiture sur laquelle parier, puis clique sur le drapeau vert pour d√©marrer la course!",-1)]))),T.raceStarted?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",c,[(0,i.Lk)("div",o,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(T.cars,function(t,e){return(0,i.uX)(),(0,i.CE)("div",{key:e,class:(0,r.C4)(["car-option",{selected:T.selectedCar===t.color}]),onClick:function(e){return L.selectCar(t.color)}},[(0,i.Lk)("div",{class:"car-preview",style:(0,r.Tr)({backgroundColor:t.color})},null,4),(0,i.Lk)("p",null,(0,r.v_)(t.name),1)],10,l)}),128))]),(0,i.Lk)("button",{onClick:e[0]||(e[0]=function(){return L.startRace&&L.startRace.apply(L,arguments)}),class:"start-button",disabled:!T.selectedCar},e[3]||(e[3]=[(0,i.Lk)("span",{class:"flag"},"üö©",-1),(0,i.eW)(" D√©marrer la course ")]),8,h)])),(0,i.Lk)("div",d,[(0,i.Lk)("canvas",u,null,512),(0,i.eW)(" "+(0,r.v_)(T.cars[0].position),1)]),T.raceFinished?((0,i.uX)(),(0,i.CE)("div",f,[e[8]||(e[8]=(0,i.Lk)("h2",null,"R√©sultats de la course",-1)),(0,i.Lk)("div",k,[(0,i.Lk)("div",p,[(0,i.Lk)("div",{class:"car-icon",style:(0,r.Tr)({backgroundColor:null===(b=T.finishOrder[1])||void 0===b?void 0:b.color})},null,4),e[4]||(e[4]=(0,i.Lk)("div",{class:"place-number"},"2",-1))]),(0,i.Lk)("div",m,[(0,i.Lk)("div",{class:"car-icon",style:(0,r.Tr)({backgroundColor:null===(R=T.finishOrder[0])||void 0===R?void 0:R.color})},null,4),e[5]||(e[5]=(0,i.Lk)("div",{class:"place-number"},"1",-1))]),(0,i.Lk)("div",v,[(0,i.Lk)("div",{class:"car-icon",style:(0,r.Tr)({backgroundColor:null===(S=T.finishOrder[2])||void 0===S?void 0:S.color})},null,4),e[6]||(e[6]=(0,i.Lk)("div",{class:"place-number"},"3",-1))])]),(0,i.Lk)("div",g,[T.playerWon?((0,i.uX)(),(0,i.CE)("h2",y,"Bravo! Tu as gagn√©!")):((0,i.uX)(),(0,i.CE)("h2",P,"Dommage! Tu as perdu.")),T.playerWon?((0,i.uX)(),(0,i.CE)("p",C,"Ta voiture "+(0,r.v_)(L.getCarName(T.selectedCar))+" a gagn√© la course!",1)):((0,i.uX)(),(0,i.CE)("p",x,"La voiture "+(0,r.v_)(L.getCarName(null===(F=T.finishOrder[0])||void 0===F?void 0:F.color))+" a gagn√© la course.",1)),(0,i.Lk)("button",{onClick:e[1]||(e[1]=function(){return L.resetGame&&L.resetGame.apply(L,arguments)}),class:"reset-button"},"Rejouer"),(0,i.bF)(M,{to:"/",class:"home-button"},{default:(0,i.k6)(function(){return e[7]||(e[7]=[(0,i.eW)("Menu Principal")])}),_:1,__:[7]})])])):(0,i.Q3)("",!0),T.raceFinished&&T.playerWon?((0,i.uX)(),(0,i.Wv)(W,{key:3,ref:"fireworks",class:"fireworks-container"},null,512)):(0,i.Q3)("",!0)])}a(113),a(1629),a(4114),a(8111),a(116),a(7588),a(6099),a(3500),a(6031);var T=a(4699);const L={name:"RaceGame",components:{Fireworks:T.j},data:function(){return{cars:[{color:"red",name:"Rouge",position:0,angle:0,speed:0,finished:!1,lap:0},{color:"blue",name:"Bleue",position:0,angle:0,speed:0,finished:!1,lap:0},{color:"green",name:"Verte",position:0,angle:0,speed:0,finished:!1,lap:0},{color:"gold",name:"Jaune",position:0,angle:0,speed:0,finished:!1,lap:0}],selectedCar:null,raceStarted:!1,raceFinished:!1,playerWon:!1,finishOrder:[],animationId:null,trackLength:0,fireworksTimer:null,ctx:null,trackPath:[],centerX:0,centerY:0}},mounted:function(){this.initializeCanvas(),this.loadImages()},beforeUnmount:function(){this.stopRace(),this.fireworksTimer&&clearTimeout(this.fireworksTimer)},methods:{initializeCanvas:function(){var t=this.$refs.raceTrack;this.ctx=t.getContext("2d"),this.centerX=t.width/2,this.centerY=t.height/2;var e=.35*Math.min(t.width,t.height);this.trackLength=300,this.createTrackPath(e)},createTrackPath:function(t){this.trackPath=[];for(var e=100,a=1.2*t,i=t,r=0;r<e;r++){var s=r/e*Math.PI*2,n=this.centerX+a*Math.cos(s),c=this.centerY+i*Math.sin(s);this.trackPath.push({x:n,y:c,angle:s})}},loadImages:function(){this.drawTrack()},selectCar:function(t){this.selectedCar=t},getCarName:function(t){var e=this.cars.find(function(e){return e.color===t});return e?e.name:""},startRace:function(){this.selectedCar&&(this.raceStarted=!0,this.cars.forEach(function(t){t.position=0,t.angle=0,t.speed=0,t.finished=!1,t.lap=0}),this.finishOrder=[],this.raceFinished=!1,this.playerWon=!1,this.animateRace())},animateRace:function(){var t=this;this.animationId&&cancelAnimationFrame(this.animationId);var e=function(){t.updateCarPositions(),t.drawTrack(),t.drawCars(),t.finishOrder.length<4&&t.raceStarted?t.animationId=requestAnimationFrame(e):4!==t.finishOrder.length||t.raceFinished||t.finishRace()};this.animationId=requestAnimationFrame(e)},updateCarPositions:function(){var t=this;this.cars.forEach(function(e){if(!e.finished){var a=.02*Math.random()+.005,i=.15*Math.random()-.075;e.speed+=a+i,e.speed*=.9,e.speed=Math.max(e.speed,.02),e.position+=e.speed;var r=Math.floor(e.position%t.trackPath.length),s=(r+1)%t.trackPath.length,n=t.trackPath[r],c=t.trackPath[s];e.angle=Math.atan2(c.y-n.y,c.x-n.x),e.position>=t.trackLength&&!e.finished&&(e.lap+=1,e.lap>=1&&(e.finished=!0,t.finishOrder.push(e)))}})},drawTrack:function(){var t=this.$refs.raceTrack,e=this.ctx;e.clearRect(0,0,t.width,t.height),e.fillStyle="#f0f0f0",e.fillRect(0,0,t.width,t.height);var a=100;e.beginPath(),e.moveTo(this.trackPath[0].x,this.trackPath[0].y);for(var i=1;i<this.trackPath.length;i++)e.lineTo(this.trackPath[i].x,this.trackPath[i].y);e.lineTo(this.trackPath[0].x,this.trackPath[0].y),e.strokeStyle="#d0d0d0",e.lineWidth=a,e.stroke(),e.beginPath(),e.moveTo(this.trackPath[0].x,this.trackPath[0].y);for(var r=1;r<this.trackPath.length;r++)e.lineTo(this.trackPath[r].x,this.trackPath[r].y);e.lineTo(this.trackPath[0].x,this.trackPath[0].y),e.strokeStyle="#888",e.lineWidth=a+8,e.stroke(),this.drawStartFinishLine(e,a)},drawRumbleStrips:function(t,e){for(var a=[],i=0;i<this.trackPath.length;i++){var r=this.trackPath[(i-1+this.trackPath.length)%this.trackPath.length],s=this.trackPath[i],n=this.trackPath[(i+1)%this.trackPath.length],c=s.x-r.x,o=s.y-r.y,l=n.x-s.x,h=n.y-s.y,d=Math.atan2(o,c),u=Math.atan2(h,l);Math.abs(d-u)>.2&&a.push(i)}for(var f=0,k=a;f<k.length;f++){var p=k[f],m=this.trackPath[p];t.save(),t.translate(m.x,m.y);var v=this.trackPath[(p+1)%this.trackPath.length],g=Math.atan2(v.y-m.y,v.x-m.x);t.rotate(g);for(var y=10,P=5,C=y*P*2,x=0;x<P;x++)t.fillStyle="#ff0000",t.fillRect(-C/2+x*y*2,-e/2-5,y,10),t.fillStyle="#ffffff",t.fillRect(-C/2+x*y*2+y,-e/2-5,y,10),t.fillStyle="#ff0000",t.fillRect(-C/2+x*y*2,e/2-5,y,10),t.fillStyle="#ffffff",t.fillRect(-C/2+x*y*2+y,e/2-5,y,10);t.restore()}},drawStartFinishLine:function(t,e){var a=this.trackPath[0];t.save(),t.translate(a.x,a.y);for(var i=10,r=Math.floor(e/i),s=0;s<r;s++)t.fillStyle=s%2===0?"#000":"#fff",t.fillRect(-e/2+s*i,-5,i,10);t.restore()},drawCars:function(){var t=this,e=this.ctx;this.cars.forEach(function(a,i){var r=Math.floor(a.position%t.trackPath.length),s=t.trackPath[r],n=15*(i-1.5),c=a.angle+Math.PI/2,o=Math.cos(c)*n,l=Math.sin(c)*n,h=s.x+o,d=s.y+l;e.save(),e.translate(h,d),e.rotate(a.angle),e.fillStyle=a.color,e.fillRect(-20,-15,40,30),e.fillStyle="#000",e.fillRect(10,-10,10,20),e.fillRect(-15,-5,20,10),e.restore()})},finishRace:function(){var t=this;this.raceFinished=!0,this.playerWon=this.finishOrder[0].color===this.selectedCar,this.playerWon&&this.$nextTick(function(){t.startFireworks()})},startFireworks:function(){var t=this;if(this.$refs.fireworks){var e=this.$refs.fireworks;e.updateOptions({autoresize:!0,opacity:.5,acceleration:1.05,friction:.97,gravity:1.5,particles:50,traceLength:3,traceSpeed:10,explosion:5,intensity:30,flickering:50,lineStyle:"round",hue:{min:0,max:360},delay:{min:30,max:60},rocketsPoint:{min:50,max:50},lineWidth:{explosion:{min:1,max:3},trace:{min:1,max:2}},brightness:{min:50,max:80},decay:{min:.015,max:.03},mouse:{click:!1,move:!1,max:1}}),e.start(),this.fireworksTimer=setTimeout(function(){t.$refs.fireworks&&t.$refs.fireworks.stop()},1e4)}},stopRace:function(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)},resetGame:function(){this.stopRace(),this.$refs.fireworks&&this.$refs.fireworks.stop(),this.fireworksTimer&&(clearTimeout(this.fireworksTimer),this.fireworksTimer=null),this.selectedCar=null,this.raceStarted=!1,this.raceFinished=!1,this.playerWon=!1,this.finishOrder=[],this.cars.forEach(function(t){t.position=0,t.angle=0,t.speed=0,t.finished=!1,t.lap=0}),this.drawTrack()}}};var b=a(1241);const R=(0,b.A)(L,[["render",w],["__scopeId","data-v-0951be5a"]]),S=R}}]);
//# sourceMappingURL=223.94be132f.js.map