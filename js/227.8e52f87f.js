"use strict";(self["webpackChunkjeux_educatifs"]=self["webpackChunkjeux_educatifs"]||[]).push([[227],{4227:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});n(8706),n(2010);var o=n(6768),a=n(4232),i={class:"game-container"},s={class:"instructions"},l={class:"game-area"},c={key:0,class:"map-container"},r={class:"map-locations"},u=["onClick"],d={class:"location-icon"},m={class:"location-name"},k={key:1,class:"location-view"},f={class:"location-header"},p={class:"location-title"},h={class:"location-icon large"},v={class:"mission-container"},L={class:"collection-area"},x={class:"snowflake-types"},y={class:"flake-icon"},F={class:"flake-name"},C={class:"flake-controls"},b=["onClick","disabled"],g={class:"flake-count"},T=["onClick","disabled"],w={class:"magic-bag"},E={class:"bag-content"},I={class:"bag-counter"},_=["disabled"],M={key:1,class:"mission-complete-message"},X={key:2,class:"victory-message"};function S(e,t,n,S,G,R){var q=(0,o.g2)("router-link"),$=(0,o.g2)("Fireworks");return(0,o.uX)(),(0,o.CE)("div",i,[t[12]||(t[12]=(0,o.Lk)("h1",null,"Les Flocons de Cristalia",-1)),(0,o.Lk)("div",s,[(0,o.Lk)("p",null,(0,a.v_)(R.currentLevel.instructions),1)]),(0,o.Lk)("div",l,[G.currentLocation?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",c,[t[3]||(t[3]=(0,o.Lk)("h2",null,"Carte du Royaume de Cristalia",-1)),(0,o.Lk)("div",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.locations,function(e,t){return(0,o.uX)(),(0,o.CE)("div",{key:t,class:(0,a.C4)(["location",{unlocked:t<=G.unlockedLocationIndex,current:t===G.currentLocationIndex}]),onClick:function(e){return R.selectLocation(t)}},[(0,o.Lk)("div",d,(0,a.v_)(e.icon),1),(0,o.Lk)("div",m,(0,a.v_)(e.name),1)],10,u)}),128))])])),G.currentLocation?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("div",f,[(0,o.Lk)("div",p,[(0,o.Lk)("div",h,(0,a.v_)(G.currentLocation.icon),1),(0,o.Lk)("h2",null,(0,a.v_)(G.currentLocation.name),1)]),(0,o.Lk)("div",v,[t[4]||(t[4]=(0,o.Lk)("h3",null,"Mission",-1)),(0,o.Lk)("p",null,(0,a.v_)(R.currentLevel.mission),1)])]),(0,o.Lk)("div",L,[(0,o.Lk)("div",x,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(R.currentLevel.availableFlakes,function(e,t){return(0,o.uX)(),(0,o.CE)("div",{key:t,class:"snowflake-type"},[(0,o.Lk)("div",y,(0,a.v_)(e.icon),1),(0,o.Lk)("div",F,(0,a.v_)(e.name),1),(0,o.Lk)("div",C,[(0,o.Lk)("button",{onClick:function(t){return R.removeFlake(e.type)},disabled:R.getFlakeCount(e.type)<=0,class:"flake-button"},"-",8,b),(0,o.Lk)("span",g,(0,a.v_)(R.getFlakeCount(e.type)),1),(0,o.Lk)("button",{onClick:function(t){return R.addFlake(e.type)},disabled:R.getFlakeCount(e.type)>=e.max||R.totalFlakes>=R.currentLevel.targetTotal,class:"flake-button"},"+",8,T)])])}),128))]),(0,o.Lk)("div",w,[t[5]||(t[5]=(0,o.Lk)("h3",null,"Sac Magique",-1)),(0,o.Lk)("div",E,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.collectedFlakes,function(e,t){return(0,o.uX)(),(0,o.CE)("div",{key:t,class:"flake-group"},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.count,function(n){return(0,o.uX)(),(0,o.CE)("div",{key:"".concat(t,"-").concat(n),class:"collected-flake"},(0,a.v_)(e.icon),1)}),128))])}),128))]),(0,o.Lk)("div",I,[(0,o.Lk)("span",null,(0,a.v_)(R.totalFlakes)+" / "+(0,a.v_)(R.currentLevel.targetTotal),1),R.currentLevel.exactTotal&&R.totalFlakes>0?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,a.C4)(["counter-status",{success:R.totalFlakes===R.currentLevel.targetTotal,error:R.totalFlakes!==R.currentLevel.targetTotal}])},(0,a.v_)(R.totalFlakes===R.currentLevel.targetTotal?"✓":R.totalFlakes<R.currentLevel.targetTotal?"Il te manque des flocons":"Trop de flocons !"),3)):(0,o.Q3)("",!0)])]),(0,o.Lk)("button",{onClick:t[0]||(t[0]=function(){return R.validateMission&&R.validateMission.apply(R,arguments)}),class:"validate-button",disabled:!R.canValidate}," Valider ",8,_)])])):(0,o.Q3)("",!0)]),G.showFeedback?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,a.C4)(["feedback-message",{success:G.feedbackSuccess}])},[(0,o.Lk)("p",null,(0,a.v_)(G.feedbackMessage),1)],2)):(0,o.Q3)("",!0),G.missionCompleted&&!G.gameCompleted?((0,o.uX)(),(0,o.CE)("div",M,[t[6]||(t[6]=(0,o.Lk)("h2",null,"Bravo !",-1)),(0,o.Lk)("p",null,"Tu as réussi la mission à "+(0,a.v_)(G.currentLocation.name)+" !",1),t[7]||(t[7]=(0,o.Lk)("p",null,"Une partie du palais de la Reine Cristalia a été reconstruite !",-1)),(0,o.Lk)("button",{onClick:t[1]||(t[1]=function(){return R.returnToMap&&R.returnToMap.apply(R,arguments)}),class:"next-button"},"Retour à la carte")])):(0,o.Q3)("",!0),G.gameCompleted?((0,o.uX)(),(0,o.CE)("div",X,[t[9]||(t[9]=(0,o.Lk)("h2",null,"Félicitations !",-1)),t[10]||(t[10]=(0,o.Lk)("p",null,"Tu as aidé la Reine Cristalia à reconstruire son palais de glace ! 🏰❄️",-1)),t[11]||(t[11]=(0,o.Lk)("p",null,"Le Royaume de Cristalia est sauvé grâce à toi !",-1)),(0,o.Lk)("button",{onClick:t[2]||(t[2]=function(){return R.resetGame&&R.resetGame.apply(R,arguments)}),class:"reset-button"},"Rejouer"),(0,o.bF)(q,{to:"/",class:"home-button"},{default:(0,o.k6)(function(){return t[8]||(t[8]=[(0,o.eW)("Menu Principal")])}),_:1,__:[8]})])):(0,o.Q3)("",!0),G.gameCompleted?((0,o.uX)(),(0,o.Wv)($,{key:3,ref:"fireworks",class:"fireworks-container"},null,512)):(0,o.Q3)("",!0)])}var G=n(3604),R=(n(8431),n(2008),n(113),n(1629),n(8111),n(1148),n(2489),n(116),n(7588),n(9432),n(6099),n(3500),n(6031),n(4699));const q={name:"CristaliaGame",components:{Fireworks:R.j},data:function(){return{currentLocationIndex:null,unlockedLocationIndex:0,currentLocation:null,missionCompleted:!1,gameCompleted:!1,showFeedback:!1,feedbackMessage:"",feedbackSuccess:!1,feedbackTimer:null,fireworksTimer:null,collectedFlakes:{},locations:[{name:"Forêt Gelée",icon:"🌲",completed:!1},{name:"Lac de Glace",icon:"❄️",completed:!1},{name:"Grotte de Cristal",icon:"💎",completed:!1},{name:"Montagne Enneigée",icon:"⛰️",completed:!1},{name:"Palais de Cristalia",icon:"🏰",completed:!1}],levels:[{instructions:"Bienvenue dans le Royaume de Cristalia ! La Reine a besoin de ton aide pour reconstruire son palais de glace. Choisis un lieu à explorer pour récolter des flocons magiques.",mission:"Collecte exactement 5 flocons ronds pour commencer la reconstruction du palais.",targetTotal:5,exactTotal:!0,constraints:[{type:"round",min:0,max:5}],availableFlakes:[{type:"round",name:"Flocons ronds",icon:"❄️",max:10}]},{instructions:"Continue ton aventure dans le Royaume de Cristalia ! Explore un nouveau lieu pour récolter plus de flocons magiques.",mission:"Collecte exactement 10 flocons en utilisant des flocons ronds et étoilés.",targetTotal:10,exactTotal:!0,constraints:[{type:"round",min:1,max:10},{type:"star",min:1,max:10}],availableFlakes:[{type:"round",name:"Flocons ronds",icon:"❄️",max:10},{type:"star",name:"Flocons étoilés",icon:"✳️",max:10}]},{instructions:"La magie du palais commence à se restaurer ! Explore un nouveau lieu pour trouver des flocons spéciaux.",mission:"Collecte exactement 7 flocons en utilisant exactement 2 types différents de flocons.",targetTotal:7,exactTotal:!0,constraints:[{type:"round",min:0,max:7},{type:"star",min:0,max:7},{type:"crystal",min:0,max:7},{typeCount:2}],availableFlakes:[{type:"round",name:"Flocons ronds",icon:"❄️",max:7},{type:"star",name:"Flocons étoilés",icon:"✳️",max:7},{type:"crystal",name:"Flocons cristaux",icon:"❇️",max:7}]},{instructions:"Le palais prend forme ! Explore un nouvel endroit pour trouver des flocons encore plus puissants.",mission:"Collecte exactement 15 flocons en utilisant au moins 3 types différents, avec au maximum 6 flocons de chaque type.",targetTotal:15,exactTotal:!0,constraints:[{type:"round",min:0,max:6},{type:"star",min:0,max:6},{type:"crystal",min:0,max:6},{type:"diamond",min:0,max:6},{typeCount:3,min:3}],availableFlakes:[{type:"round",name:"Flocons ronds",icon:"❄️",max:6},{type:"star",name:"Flocons étoilés",icon:"✳️",max:6},{type:"crystal",name:"Flocons cristaux",icon:"❇️",max:6},{type:"diamond",name:"Flocons diamants",icon:"💠",max:6}]},{instructions:"C'est le moment de terminer la reconstruction du palais ! Rends-toi au Palais de Cristalia pour l'ultime mission.",mission:"Collecte exactement 20 flocons magiques. Attention, les flocons diamants sont gelés et comptent double !",targetTotal:20,exactTotal:!0,constraints:[{type:"round",min:0,max:10},{type:"star",min:0,max:10},{type:"crystal",min:0,max:10},{type:"diamond",min:0,max:5,multiplier:2}],availableFlakes:[{type:"round",name:"Flocons ronds",icon:"❄️",max:10},{type:"star",name:"Flocons étoilés",icon:"✳️",max:10},{type:"crystal",name:"Flocons cristaux",icon:"❇️",max:10},{type:"diamond",name:"Flocons diamants (comptent double)",icon:"💠",max:5}]}]}},computed:{currentLevel:function(){return this.levels[this.unlockedLocationIndex]||this.levels[0]},totalFlakes:function(){var e=0;for(var t in this.collectedFlakes){var n=this.getMultiplier(t);e+=this.collectedFlakes[t].count*n}return e},canValidate:function(){var e=this;if(this.currentLevel.exactTotal&&this.totalFlakes!==this.currentLevel.targetTotal)return!1;var t,n=(0,G.A)(this.currentLevel.constraints);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.type){var a=this.getFlakeCount(o.type);if(void 0!==o.min&&a<o.min)return!1;if(void 0!==o.max&&a>o.max)return!1}if(void 0!==o.typeCount){var i=Object.keys(this.collectedFlakes).filter(function(t){return e.collectedFlakes[t].count>0}).length;if(void 0!==o.min&&i<o.min)return!1;if(i!==o.typeCount)return!1}}}catch(s){n.e(s)}finally{n.f()}return!0}},created:function(){this.initializeGame()},mounted:function(){},beforeUnmount:function(){this.fireworksTimer&&clearTimeout(this.fireworksTimer),this.feedbackTimer&&clearTimeout(this.feedbackTimer)},methods:{initializeGame:function(){this.currentLocationIndex=null,this.unlockedLocationIndex=0,this.currentLocation=null,this.missionCompleted=!1,this.gameCompleted=!1,this.resetCollectedFlakes(),this.locations.forEach(function(e){e.completed=!1})},resetCollectedFlakes:function(){var e=this;this.collectedFlakes={},this.currentLevel&&this.currentLevel.availableFlakes.forEach(function(t){e.collectedFlakes[t.type]={count:0,icon:t.icon}})},selectLocation:function(e){e<=this.unlockedLocationIndex&&(this.currentLocationIndex=e,this.currentLocation=this.locations[e],this.missionCompleted=!1,this.resetCollectedFlakes())},returnToMap:function(){null!==this.currentLocationIndex&&this.locations[this.currentLocationIndex].completed&&this.currentLocationIndex===this.unlockedLocationIndex&&this.unlockedLocationIndex<this.locations.length-1&&this.unlockedLocationIndex++,this.currentLocation=null,this.missionCompleted=!1},addFlake:function(e){this.collectedFlakes[e]||(this.collectedFlakes[e]={count:0,icon:this.currentLevel.availableFlakes.find(function(t){return t.type===e}).icon});var t=this.currentLevel.availableFlakes.find(function(t){return t.type===e});this.collectedFlakes[e].count<t.max&&this.totalFlakes<this.currentLevel.targetTotal&&this.collectedFlakes[e].count++},removeFlake:function(e){this.collectedFlakes[e]&&this.collectedFlakes[e].count>0&&this.collectedFlakes[e].count--},getFlakeCount:function(e){return this.collectedFlakes[e]?this.collectedFlakes[e].count:0},getMultiplier:function(e){var t=this.currentLevel.constraints.find(function(t){return t.type===e&&t.multiplier});return t?t.multiplier:1},validateMission:function(){var e=this;this.canValidate?(this.showSuccessFeedback(),this.locations[this.currentLocationIndex].completed=!0,setTimeout(function(){e.missionCompleted=!0,e.$nextTick(function(){var e=document.querySelector(".mission-complete-message");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}),e.locations.every(function(e){return e.completed})&&setTimeout(function(){e.gameCompleted=!0,e.$nextTick(function(){e.startFireworks();var t=document.querySelector(".victory-message");t&&t.scrollIntoView({behavior:"smooth",block:"center"})})},2e3)},1e3)):this.currentLevel.exactTotal&&this.totalFlakes!==this.currentLevel.targetTotal?this.showErrorFeedback("Tu dois collecter exactement ".concat(this.currentLevel.targetTotal," flocons !")):this.showErrorFeedback("Vérifie bien les contraintes de la mission !")},showSuccessFeedback:function(){var e=this;this.feedbackSuccess=!0,this.feedbackMessage="Bravo ! Tu as réussi la mission !",this.showFeedback=!0,this.feedbackTimer&&clearTimeout(this.feedbackTimer),this.feedbackTimer=setTimeout(function(){e.showFeedback=!1},2e3)},showErrorFeedback:function(e){var t=this;this.feedbackSuccess=!1,this.feedbackMessage=e,this.showFeedback=!0,this.feedbackTimer&&clearTimeout(this.feedbackTimer),this.feedbackTimer=setTimeout(function(){t.showFeedback=!1},2e3)},startFireworks:function(){var e=this;if(this.$refs.fireworks){var t=this.$refs.fireworks;t.updateOptions({autoresize:!0,opacity:.5,acceleration:1.05,friction:.97,gravity:1.5,particles:50,traceLength:3,traceSpeed:10,explosion:5,intensity:30,flickering:50,lineStyle:"round",hue:{min:180,max:240},delay:{min:30,max:60},rocketsPoint:{min:50,max:50},lineWidth:{explosion:{min:1,max:3},trace:{min:1,max:2}},brightness:{min:50,max:80},decay:{min:.015,max:.03},mouse:{click:!1,move:!1,max:1}}),t.start(),this.fireworksTimer=setTimeout(function(){e.$refs.fireworks&&e.$refs.fireworks.stop()},1e4)}},resetGame:function(){this.$refs.fireworks&&this.$refs.fireworks.stop(),this.fireworksTimer&&(clearTimeout(this.fireworksTimer),this.fireworksTimer=null),this.initializeGame()}}};var $=n(1241);const Q=(0,$.A)(q,[["render",S],["__scopeId","data-v-6e8d60e2"]]),V=Q}}]);
//# sourceMappingURL=227.8e52f87f.js.map