"use strict";(self["webpackChunkjeux_educatifs"]=self["webpackChunkjeux_educatifs"]||[]).push([[124],{9124:(e,t,i)=>{i.r(t),i.d(t,{default:()=>D});var n=i(6768),a=i(4232),s=i(5130),r={class:"game-container"},o={class:"game-area"},c={class:"customer-container"},u={class:"customer"},l={class:"shopping-list"},m={class:"shopping-items"},p={class:"item-icon"},d={class:"item-quantity"},h={class:"item-counter"},f={class:"checkout-area"},y={class:"container-wrapper stall-wrapper"},k={class:"stall-container"},v=["onDragstart"],g={key:1,class:"level-complete-message"},L={key:2,class:"victory-message"};function b(e,t,i,b,I,w){var T=(0,n.g2)("router-link"),C=(0,n.g2)("Fireworks");return(0,n.uX)(),(0,n.CE)("div",r,[t[13]||(t[13]=(0,n.Lk)("h1",null,"Le Marché Magique",-1)),t[14]||(t[14]=(0,n.Lk)("div",{class:"instructions"},[(0,n.Lk)("p",null,"Aide le client à faire ses courses en plaçant les bons fruits et légumes sur le tapis de caisse")],-1)),(0,n.Lk)("div",o,[(0,n.Lk)("div",c,[(0,n.Lk)("div",u,(0,a.v_)(I.currentCustomer.icon),1),(0,n.Lk)("div",l,[t[4]||(t[4]=(0,n.Lk)("h3",null,"Liste de courses",-1)),(0,n.Lk)("div",m,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(I.currentLevel.shoppingList,function(e,t){return(0,n.uX)(),(0,n.CE)("div",{key:t,class:"shopping-item"},[(0,n.Lk)("div",p,(0,a.v_)(e.icon),1),(0,n.Lk)("div",d,(0,a.v_)(e.quantity),1),(0,n.Lk)("div",h,(0,a.v_)(w.getItemCount(e.type))+"/"+(0,a.v_)(e.quantity),1)])}),128))])])]),(0,n.Lk)("div",{class:"checkout-container",onDragover:t[0]||(t[0]=(0,s.D$)(function(){},["prevent"])),onDrop:t[1]||(t[1]=function(e){return w.dropItem(e)})},[t[5]||(t[5]=(0,n.Lk)("h3",{class:"container-title"},"Tapis de caisse",-1)),(0,n.Lk)("div",f,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(I.placedItems,function(e){return(0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"item-in-checkout",style:(0,a.Tr)({position:"absolute",left:e.position.x+"px",top:e.position.y+"px"})},(0,a.v_)(e.icon),5)}),128))])],32),(0,n.Lk)("div",y,[t[6]||(t[6]=(0,n.Lk)("h3",{class:"container-title"},"Étalage du marché",-1)),(0,n.Lk)("div",k,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(I.marketItems,function(e,t){return(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",{key:t,class:(0,a.C4)(["market-item",{placed:e.placed}]),draggable:"true",onDragstart:function(t){return w.dragStart(t,e)},style:(0,a.Tr)({position:"absolute",left:e.stallPosition.x+"px",top:e.stallPosition.y+"px"})},(0,a.v_)(e.icon),47,v)),[[s.aG,!e.placed]])}),128))])])]),I.showFeedback?((0,n.uX)(),(0,n.CE)("div",{key:0,class:(0,a.C4)(["feedback-message",{success:I.feedbackSuccess}])},[(0,n.Lk)("p",null,(0,a.v_)(I.feedbackMessage),1)],2)):(0,n.Q3)("",!0),I.levelCompleted?((0,n.uX)(),(0,n.CE)("div",g,[t[7]||(t[7]=(0,n.Lk)("h2",null,"Bravo !",-1)),t[8]||(t[8]=(0,n.Lk)("p",null,"Tu as bien rempli la commande du client !",-1)),(0,n.Lk)("button",{onClick:t[2]||(t[2]=function(){return w.nextLevel&&w.nextLevel.apply(w,arguments)}),class:"next-button"},"Client suivant")])):(0,n.Q3)("",!0),I.gameCompleted?((0,n.uX)(),(0,n.CE)("div",L,[t[10]||(t[10]=(0,n.Lk)("h2",null,"Félicitations !",-1)),t[11]||(t[11]=(0,n.Lk)("p",null,"Tu es devenu un Super Marchand ! 🏅",-1)),t[12]||(t[12]=(0,n.Lk)("p",null,"Tu as servi tous les clients du Marché Magique !",-1)),(0,n.Lk)("button",{onClick:t[3]||(t[3]=function(){return w.resetGame&&w.resetGame.apply(w,arguments)}),class:"reset-button"},"Rejouer"),(0,n.bF)(T,{to:"/",class:"home-button"},{default:(0,n.k6)(function(){return t[9]||(t[9]=[(0,n.eW)("Menu Principal")])}),_:1,__:[9]})])):(0,n.Q3)("",!0),I.gameCompleted?((0,n.uX)(),(0,n.Wv)(C,{key:3,ref:"fireworks",class:"fireworks-container"},null,512)):(0,n.Q3)("",!0)])}var I=i(8653),w=i(9258),T=i(3604),C=(i(8431),i(2008),i(113),i(1629),i(4114),i(8111),i(1148),i(2489),i(116),i(7588),i(6099),i(3500),i(6031),i(4699));const q={name:"MagicMarketGame",components:{Fireworks:C.j},data:function(){return{currentLevel:null,currentLevelIndex:0,levels:[{shoppingList:[{type:"carrot",icon:"🥕",quantity:2}]},{shoppingList:[{type:"apple",icon:"🍎",quantity:3}]},{shoppingList:[{type:"banana",icon:"🍌",quantity:1},{type:"tomato",icon:"🍅",quantity:2}]},{shoppingList:[{type:"lemon",icon:"🍋",quantity:3},{type:"strawberry",icon:"🍓",quantity:2}]},{shoppingList:[{type:"carrot",icon:"🥕",quantity:4},{type:"apple",icon:"🍎",quantity:3}]},{shoppingList:[{type:"banana",icon:"🍌",quantity:2},{type:"tomato",icon:"🍅",quantity:3},{type:"lemon",icon:"🍋",quantity:1}]},{shoppingList:[{type:"strawberry",icon:"🍓",quantity:4},{type:"carrot",icon:"🥕",quantity:2},{type:"apple",icon:"🍎",quantity:3}]},{shoppingList:[{type:"banana",icon:"🍌",quantity:5},{type:"tomato",icon:"🍅",quantity:3},{type:"lemon",icon:"🍋",quantity:4}]},{shoppingList:[{type:"strawberry",icon:"🍓",quantity:6},{type:"carrot",icon:"🥕",quantity:3},{type:"apple",icon:"🍎",quantity:4},{type:"banana",icon:"🍌",quantity:2}]},{shoppingList:[{type:"tomato",icon:"🍅",quantity:7},{type:"lemon",icon:"🍋",quantity:5},{type:"strawberry",icon:"🍓",quantity:8},{type:"carrot",icon:"🥕",quantity:4}]}],customers:[{icon:"🐰",name:"Lapin"},{icon:"🦊",name:"Renard"},{icon:"🐸",name:"Grenouille"},{icon:"🦁",name:"Lion"},{icon:"🐻",name:"Ours"},{icon:"🐼",name:"Panda"},{icon:"🦄",name:"Licorne"},{icon:"🐢",name:"Tortue"},{icon:"🦉",name:"Hibou"},{icon:"🐿️",name:"Écureuil"}],currentCustomer:null,marketItems:[],placedItems:[],currentDraggedItem:null,levelCompleted:!1,gameCompleted:!1,fireworksTimer:null,showFeedback:!1,feedbackMessage:"",feedbackSuccess:!1,feedbackTimer:null,itemTypes:[{type:"carrot",icon:"🥕"},{type:"apple",icon:"🍎"},{type:"banana",icon:"🍌"},{type:"tomato",icon:"🍅"},{type:"lemon",icon:"🍋"},{type:"strawberry",icon:"🍓"}]}},created:function(){this.initializeGame()},mounted:function(){document.addEventListener("dragend",this.handleDragEnd)},beforeUnmount:function(){document.removeEventListener("dragend",this.handleDragEnd),this.fireworksTimer&&clearTimeout(this.fireworksTimer),this.feedbackTimer&&clearTimeout(this.feedbackTimer)},methods:{initializeGame:function(){this.currentLevelIndex=0,this.loadLevel(),this.gameCompleted=!1},loadLevel:function(){this.currentLevel=this.levels[this.currentLevelIndex],this.currentCustomer=this.customers[this.currentLevelIndex],this.levelCompleted=!1,this.placedItems=[],this.generateMarketItems()},generateMarketItems:function(){var e=this;this.marketItems=[];var t=0,i=30,n=i+5,a=function(e,t,i){var a,s=(0,T.A)(i);try{for(s.s();!(a=s.n()).done;){var r=a.value,o=Math.abs(r.stallPosition.x-e),c=Math.abs(r.stallPosition.y-t),u=Math.sqrt(o*o+c*c);if(u<n)return!0}}catch(l){s.e(l)}finally{s.f()}return!1},s=function(e){var t,n,s=300-i,r=150-i,o=0;do{t=Math.floor(Math.random()*s),n=Math.floor(Math.random()*r),o++}while(a(t,n,e)&&o<50);return{x:t,y:n}};this.currentLevel.shoppingList.forEach(function(i){for(var n=0;n<i.quantity;n++){var a=s(e.marketItems);e.marketItems.push({id:t++,type:i.type,icon:i.icon,placed:!1,position:{x:0,y:0},stallPosition:a})}});for(var r=10,o=0;o<r;o++){var c=this.itemTypes[Math.floor(Math.random()*this.itemTypes.length)],u=s(this.marketItems);this.marketItems.push({id:t++,type:c.type,icon:c.icon,placed:!1,position:{x:0,y:0},stallPosition:u})}this.marketItems=this.shuffleArray(this.marketItems)},shuffleArray:function(e){for(var t=(0,w.A)(e),i=t.length-1;i>0;i--){var n=Math.floor(Math.random()*(i+1)),a=[t[n],t[i]];t[i]=a[0],t[n]=a[1]}return t},dragStart:function(e,t){this.currentDraggedItem=t,e.dataTransfer.setData("text/plain",t.id)},dropItem:function(e){var t=this;if(e.preventDefault(),this.currentDraggedItem&&!this.currentDraggedItem.placed&&!this.levelCompleted){var i=e.currentTarget.getBoundingClientRect(),n=30,a=e.clientX-i.left-n/2,s=e.clientY-i.top-n/2,r=this.currentLevel.shoppingList.find(function(e){return e.type===t.currentDraggedItem.type});if(r){var o=this.getItemCount(this.currentDraggedItem.type);o<r.quantity?(this.currentDraggedItem.placed=!0,this.currentDraggedItem.position={x:a,y:s},this.placedItems.push((0,I.A)({},this.currentDraggedItem)),this.isShoppingListComplete()&&(this.showSuccessFeedback(),setTimeout(function(){t.levelCompleted=!0,t.currentLevelIndex===t.levels.length-1&&setTimeout(function(){t.gameCompleted=!0,t.$nextTick(function(){t.startFireworks()})},2e3)},1e3))):this.showErrorFeedback("Tu as déjà assez de "+this.getItemName(this.currentDraggedItem.type)+"!")}else this.showErrorFeedback("Ce n'est pas ce que le client a demandé!")}},handleDragEnd:function(){this.currentDraggedItem=null},getItemCount:function(e){return this.placedItems.filter(function(t){return t.type===e}).length},getItemName:function(e){switch(e){case"carrot":return"carottes";case"apple":return"pommes";case"banana":return"bananes";case"tomato":return"tomates";case"lemon":return"citrons";case"strawberry":return"fraises";default:return e}},isShoppingListComplete:function(){var e=this;return this.currentLevel.shoppingList.every(function(t){return e.getItemCount(t.type)===t.quantity})},showSuccessFeedback:function(){var e=this;this.feedbackSuccess=!0,this.feedbackMessage="Bravo ! Tu as bien rempli la commande !",this.showFeedback=!0,this.feedbackTimer&&clearTimeout(this.feedbackTimer),this.feedbackTimer=setTimeout(function(){e.showFeedback=!1},2e3)},showErrorFeedback:function(e){var t=this;this.feedbackSuccess=!1,this.feedbackMessage=e,this.showFeedback=!0,this.feedbackTimer&&clearTimeout(this.feedbackTimer),this.feedbackTimer=setTimeout(function(){t.showFeedback=!1},2e3)},nextLevel:function(){this.currentLevelIndex++,this.loadLevel()},startFireworks:function(){var e=this;if(this.$refs.fireworks){var t=this.$refs.fireworks;t.updateOptions({autoresize:!0,opacity:.5,acceleration:1.05,friction:.97,gravity:1.5,particles:50,traceLength:3,traceSpeed:10,explosion:5,intensity:30,flickering:50,lineStyle:"round",hue:{min:0,max:360},delay:{min:30,max:60},rocketsPoint:{min:50,max:50},lineWidth:{explosion:{min:1,max:3},trace:{min:1,max:2}},brightness:{min:50,max:80},decay:{min:.015,max:.03},mouse:{click:!1,move:!1,max:1}}),t.start(),this.fireworksTimer=setTimeout(function(){e.$refs.fireworks&&e.$refs.fireworks.stop()},1e4)}},resetGame:function(){this.$refs.fireworks&&this.$refs.fireworks.stop(),this.fireworksTimer&&(clearTimeout(this.fireworksTimer),this.fireworksTimer=null),this.initializeGame()}}};var x=i(1241);const M=(0,x.A)(q,[["render",b],["__scopeId","data-v-98fe2e68"]]),D=M}}]);
//# sourceMappingURL=124.9d820009.js.map